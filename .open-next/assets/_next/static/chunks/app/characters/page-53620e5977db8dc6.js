(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{8825:function(e,t,a){Promise.resolve().then(a.bind(a,1132))},1132:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var s=a(7437),n=a(2265),l=a(3011);let r="https://rickandmortyapi.com/api/character";async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l="".concat(r,"?page=").concat(e);if(t&&(l+="&name=".concat(encodeURIComponent(t))),a.length>0){var c;let l=a.map(a=>{let l="".concat(r,"?page=").concat(e);return t&&(l+="&name=".concat(encodeURIComponent(t))),l+="&status=".concat(encodeURIComponent(a)),s.length>0&&(l+="&species=".concat(encodeURIComponent(s[0]))),n.length>0&&(l+="&gender=".concat(encodeURIComponent(n[0]))),fetch(l).then(e=>e.json())}),o=await Promise.all(l),i=Array.from(new Map(o.flatMap(e=>e.results||[]).map(e=>[e.id,e])).values());return s.length>0&&(i=i.filter(e=>s.includes(e.species))),n.length>0&&(i=i.filter(e=>n.includes(e.gender))),{results:i,info:(null===(c=o[0])||void 0===c?void 0:c.info)||{pages:1,count:i.length,next:null,prev:null}}}1===a.length&&(l+="&status=".concat(encodeURIComponent(a[0]))),s.length>0&&(l+="&species=".concat(encodeURIComponent(s[0]))),n.length>0&&(l+="&gender=".concat(encodeURIComponent(n[0])));let o=await fetch(l);if(!o.ok)throw Error("API error");let i=await o.json(),d=i.results||[];return s.length>1&&(d=d.filter(e=>s.includes(e.species))),n.length>1&&(d=d.filter(e=>n.includes(e.gender))),{...i,results:d}}let o=(0,l.U)((e,t)=>({characters:[],loading:!1,error:null,page:1,totalPages:1,search:"",status:[],species:[],gender:[],fetchData:async()=>{e({loading:!0,error:null});try{let{page:a,search:s,status:n,species:l,gender:r}=t();console.log("Fetching with params:",{page:a,search:s,status:n,species:l,gender:r});let o=await c(a,s,n,l,r);console.log("Received data:",{resultsCount:o.results.length,totalPages:o.info.pages,currentPage:a}),e({characters:o.results,totalPages:o.info.pages||1,loading:!1})}catch(t){console.error("Error fetching data:",t),e({error:t.message,loading:!1,characters:[]})}},setPage:a=>{let s=t().page,n=Math.max(1,Math.min(a,t().totalPages));n!==s&&(console.log("Setting page from",s,"to",n),e({page:n}))},setSearch:t=>{console.log("Setting search:",t),e({search:t,page:1})},toggleStatus:a=>{let s=t().status,n=s.includes(a)?s.filter(e=>e!==a):[...s,a];console.log("Toggling status:",a,"->",n),e({status:n,page:1})},toggleSpecies:a=>{let s=t().species,n=s.includes(a)?s.filter(e=>e!==a):[...s,a];console.log("Toggling species:",a,"->",n),e({species:n,page:1})},toggleGender:a=>{let s=t().gender,n=s.includes(a)?s.filter(e=>e!==a):[...s,a];console.log("Toggling gender:",a,"->",n),e({gender:n,page:1})},resetFilters:()=>{console.log("Resetting filters"),e({search:"",status:[],species:[],gender:[],page:1})}}));var i=a(7648);function d(e){let{character:t}=e,a="alive"===t.status.toLowerCase()?"status-alive":"dead"===t.status.toLowerCase()?"status-dead":"status-unknown";return(0,s.jsxs)(i.default,{href:"/characters/".concat(t.id),className:"character-card",children:[(0,s.jsx)("div",{className:"status-tag ".concat(a),children:t.status}),(0,s.jsx)("div",{className:"aspect-square",children:(0,s.jsx)("img",{src:t.image,alt:t.name,className:"character-card-image",loading:"lazy"})}),(0,s.jsxs)("div",{className:"character-card-content",children:[(0,s.jsx)("h2",{className:"character-card-name",children:t.name}),(0,s.jsx)("span",{className:"character-card-species",children:t.species})]})]})}function g(e){let{value:t,onChange:a}=e,[l,r]=(0,n.useState)(t),[c,o]=(0,n.useState)(t);return(0,n.useEffect)(()=>{r(t)},[t]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{o(l)},500);return()=>clearTimeout(e)},[l]),(0,n.useEffect)(()=>{c!==t&&a(c)},[c,t,a]),(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search by name...",value:l,onChange:e=>{r(e.target.value)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l&&(0,s.jsx)("button",{onClick:()=>{r("")},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",type:"button","aria-label":"Clear search",children:"✕"})]})}function u(e){let{label:t,selected:a,onToggle:n,options:l}=e;return(0,s.jsxs)("div",{className:"filter-multi-select",children:[(0,s.jsxs)("span",{className:"filter-label",children:[t,":"]}),(0,s.jsx)("div",{className:"filter-options",children:l.slice(1).map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>n(e),className:"filter-option ".concat(a.includes(e)?"active":""),children:e},e))})]})}function h(e){let{currentPage:t,totalPages:a,onPageChange:n}=e,l=e=>{console.log("Pagination: goToPage called with",e),e<1||e>a||e===t||n(e)},r=(()=>{let e=[];for(let s=1;s<=a;s++)1===s||s===a||s>=t-2&&s<=t+2?e.push(s):(s===t-2-1||s===t+2+1)&&e.push("...");return e.filter((e,t,a)=>!("..."===e&&"..."===a[t-1]))})();return(0,s.jsxs)("div",{className:"pagination-container",children:[(0,s.jsx)("button",{onClick:()=>l(t-1),disabled:1===t,className:"pagination-button","aria-label":"Go to previous page",children:"← Previous"}),(0,s.jsx)("div",{className:"hidden sm:flex items-center gap-1",children:r.map((e,a)=>"..."===e?(0,s.jsx)("span",{className:"px-3 py-2 text-gray-400","aria-hidden":"true",children:"…"},"ellipsis-".concat(a)):(0,s.jsx)("button",{onClick:()=>l(e),className:"px-3 py-2 min-w-[40px] rounded-md transition-all duration-200 ".concat(t===e?"bg-[#0ab1c7] text-black font-bold scale-110 shadow-lg":"bg-var(--bg-tertiary) text-var(--text-primary) hover:bg-var(--border-color)"),"aria-current":t===e?"page":void 0,"aria-label":"Go to page ".concat(e),children:e},"page-".concat(e)))}),(0,s.jsxs)("div",{className:"pagination-info",children:["Page ",(0,s.jsx)("span",{className:"current-page",children:t})," of ",(0,s.jsx)("span",{children:a})]}),(0,s.jsx)("button",{onClick:()=>l(t+1),disabled:t===a,className:"pagination-button","aria-label":"Go to next page",children:"Next →"})]})}function p(){return(0,s.jsxs)("div",{className:"skeleton",children:[(0,s.jsx)("div",{className:"skeleton-image"}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"skeleton-text skeleton-text-short"}),(0,s.jsx)("div",{className:"skeleton-text skeleton-text-medium"})]})]})}function m(e){let{message:t}=e;return(0,s.jsxs)("div",{className:"error-message",children:[(0,s.jsx)("svg",{className:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t]})}function x(){let{characters:e,loading:t,error:a,fetchData:l,search:r,status:c,species:i,gender:x,setSearch:f,toggleStatus:v,toggleSpecies:j,toggleGender:N,resetFilters:b,page:k,totalPages:w,setPage:C}=o();return((0,n.useEffect)(()=>{l()},[k,r,c,i,x]),t)?(0,s.jsx)("div",{className:"characters-page",children:(0,s.jsx)("div",{className:"grid grid-cols-6 gap-4",children:Array(12).fill(0).map((e,t)=>(0,s.jsx)(p,{},t))})}):a?(0,s.jsx)(m,{message:a}):(0,s.jsxs)("div",{className:"characters-page",children:[(0,s.jsxs)("div",{className:"filters-row",children:[(0,s.jsx)(g,{value:r,onChange:f}),(0,s.jsx)(u,{label:"Status",selected:c,onToggle:v,options:["All","Alive","Dead","Unknown"]}),(0,s.jsx)(u,{label:"Species",selected:i,onToggle:j,options:["All","Human","Alien","Humanoid"]}),(0,s.jsx)(u,{label:"Gender",selected:x,onToggle:N,options:["All","Male","Female","Genderless"]}),(0,s.jsx)("button",{onClick:b,className:"reset-button",children:"Reset Filters"})]}),0===e.length?(0,s.jsx)(m,{message:"No characters found"}):(0,s.jsx)("div",{className:"grid grid-cols-6 gap-4",children:e.map(e=>(0,s.jsx)(d,{character:e},e.id))}),(0,s.jsx)(h,{currentPage:k,totalPages:w,onPageChange:C})]})}}},function(e){e.O(0,[582,971,117,744],function(){return e(e.s=8825)}),_N_E=e.O()}]);